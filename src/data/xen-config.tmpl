#
# Configuration file for the Xen instance {$hostname}, 
# created by ANSTE on { scalar localtime }.
#

#
#  Kernel + memory size
#
{
    my $kernel = '/boot/vmlinuz-' . `uname -r`;
    chomp($kernel);
    $OUT.= "kernel      = '$kernel'";
}
{
    my $initrd = '/boot/initrd.img-' . `uname -r`;
    chomp($initrd);
    $OUT.= "ramdisk     = '$initrd'";
}
memory      = '{$memory}'

#
#  Disk device(s).
#
root        = '/dev/{$device}1 ro'

{ 
  my $image_vbd = "file:$path/$hostname/disk.img";
  my $swap_vbd = "file:$path/$hostname/swap.img";

  if ( $noswap ) 
  {
        $OUT .= "disk        = [ '$image_vbd,$device" . "1,w' ]";
  }
  else
  {
        $OUT .= "disk        = [ '$image_vbd,$device" . "1,w', '$swap_vbd,$device" . "2,w' ]";
  }
}

#
#  Hostname
#
name        = '{$hostname}'

#
#  Networking
#
{ if ( $dhcp )
  {
    $OUT .= "dhcp        = 'dhcp'\n";
    $OUT .= "vif         = [ '' ]";
  }    
  else
  {
    $OUT .= "vif         = [ 'ip=$ip' ]"; 
  }
}

#
#  Behaviour
#
on_poweroff = 'destroy'
on_reboot   = 'restart'
on_crash    = 'restart'

